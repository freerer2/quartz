## 서버 기본설정
[[서버 기본환경 설정|서버 기본환경 설정]]을 선행한다.

## 설치 준비

### 의존성 설치

```sh
sudo apt update
curl -fsSL https://deb.nodesource.com/setup_lts.x | sudo -E bash -
sudo apt install -y nodejs
```

### 사용자 생성

wiki-js를 실행할 사용자를 생성합니다(예: `wiki`)

```sh
sudo adduser --system --shell /bin/bash --gecos 'Wiki-js' --group --disabled-password --home /home/wiki wiki

sudo passwd wiki
```

## 설치
### 설치파일 내려받기

```sh
cd ~
sudo mkdir -p ./opt/wikijs
wget https://github.com/Requarks/wiki/releases/latest/download/wiki-js.tar.gz
tar xzf wiki-js.tar.gz -C ./opt/wikijs
```
## 데이터베이스 세팅

[[프로젝트 관리/서버/데이터베이스 서버/index|데이터베이스 서버]] 참조

## 추가 설정
### 연결할 데이터베이스 설정

```sh
cd opt/wikijs
cp config.sample.yml config.yml

# 데이터베이스 설정
vi /home/wiki/opt/wikijs/config.yml
```

유저 추가 필요시 [[프로젝트 관리/서버/데이터베이스 서버/2. PostgreSQL User 추가|2. PostgreSQL User 추가]] 참조 

```yml
db:
	type: postgres
	host: localhost
	port: 5432
	user: [유저명]
	pass: [비밀번호]
	db: [DB명]
```


## 서비스 등록

### systemd 서비스 생성

`sudo vi /etc/systemd/system/wikijs.service`

```service
[Unit]
Description=Wiki.js
After=network.target

[Service]
Type=simple
ExecStart=/usr/bin/node server
server Restart=always
User=wiki
Environment=NODE_ENV=production
WorkingDirectory=/home/wiki/opt/wikijs

[Install]
WantedBy=multi-user.target
```

부팅 시 Gitea를 활성화하고 시작합니다.

```sh
sudo systemctl enable wikijs
sudo systemctl start wikijs
```

systemd 버전 220 이상을 사용하는 경우 다음을 통해 Gitea를 활성화하고 즉시 시작할 수 있습니다.

```sh
sudo systemctl enable wikijs --now
```
### 서비스 최초 실행

```sh
sudo systemctl daemon-reload
sudo systemctl enable wikijs
sudo systemctl start wikijs
```